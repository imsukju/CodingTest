# Main
```java
package com.test1017;

import java.io.File;

import org.apache.catalina.Context;

import org.apache.catalina.startup.Tomcat;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import com.test1017.config.Appconfig;
import com.test1017.entity.User;

import jakarta.persistence.EntityManager;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.Persistence;
import jakarta.persistence.PersistenceContext;

public class Main {

	static EntityManager em;

	public static void main(String[] args) throws Exception {


 
        
        // 임베디드 톰캣 생성 및 설정

		
        Tomcat tomcat = new Tomcat();
        tomcat.setPort(8080);

        // 웹 애플리케이션 컨텍스트 경로 설정
        String contextPath = "";
        String docBase = new File("src/main/webapp").getAbsolutePath();
        Context ctx = tomcat.addWebapp(contextPath, docBase);

        if (ctx == null) {
            System.out.println("Context creation failed.");
            return;
        }

        // 톰캣 서버 시작
        tomcat.getConnector();  // 커넥터 초기화
        tomcat.start();
        tomcat.getServer().await();  // 서버 대기
    }
	


}

```

# Config

## AppConfig   
```java   
package com.test1017.config;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.orm.jpa.JpaTransactionManager;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;

import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.Persistence;

@Configuration
@EnableTransactionManagement
@ComponentScan(basePackages = {"com.test1017.init","com.test1017.dao","com.test1017.service"})
public class Appconfig {
	@Bean EntityManagerFactory entityfactory()
	{
		return Persistence.createEntityManagerFactory("jpabook");
		
	}
	
	
	 @Bean
	    public PlatformTransactionManager transactionManager(EntityManagerFactory emf) {
	        JpaTransactionManager transactionManager = new JpaTransactionManager();
	        transactionManager.setEntityManagerFactory(emf);
	        return transactionManager;
	    }
}

```   


## WebConfig   
```java
package com.test1017.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.web.servlet.view.InternalResourceViewResolver;

@ComponentScan(basePackages = {"com.test1017.controller"})
public class Webconfig {
	@Bean
	public InternalResourceViewResolver viewResolver() {
	    InternalResourceViewResolver resolver = new InternalResourceViewResolver();
	    resolver.setPrefix("/WEB-INF/views/"); 
	    resolver.setSuffix(".jsp");  
	    return resolver;
	}
}


```   


# Contorller
## CommentContoller
```java
package com.test1017.controller.comment;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import com.test1017.converter.CommentDTOconverter;
import com.test1017.dao.impl.UserDao;
import com.test1017.dto.CommentDTO;
import com.test1017.entity.Comment;
import com.test1017.entity.Post;
import com.test1017.service.CommentService;
import com.test1017.service.EntityCallback;
import com.test1017.service.PostService;

@Controller
public class CommentContoller {
	private static final int PAGE_SIZE = 5; 
	@Autowired
	PostService postService;
	
	@Autowired
	@Qualifier("userDao")
	UserDao userDao;
	
    @Autowired
    @Qualifier("postCallbackImpl")
    private EntityCallback<Post> postCallbackImpl;
    
	@Autowired
	@Qualifier("commentService")
	CommentService commentService;
	
	@Autowired
	@Qualifier("commentServiceCallbcak")
	private EntityCallback<Comment> commentServiceCallbcak;

	
    @GetMapping("/posts/{postid}/comments/{commentid}/edit")
    public String getMethodName(@PathVariable("postid") Long postid,@PathVariable("commentid") Long commentid
    		,Model model) {
    	Comment comment = commentService.findById(commentid, commentServiceCallbcak);
    	Post post = postService.findById(commentid, postCallbackImpl);
    	Comment c = commentService.findById(commentid, commentServiceCallbcak);
    	CommentDTO cdto = CommentDTOconverter.toDto(c);
    	model.addAttribute("comment",cdto);
    	model.addAttribute("post",post);
    	
    	
    

        return "comment/edit_comment";
    }
    
    
    @PostMapping("/posts/{postid}/comments/{commentid}/edit")
    public String postEditComment(@PathVariable("postid") Long postid,@PathVariable("commentid")Long commentid,
    		@RequestParam("text") String text, Model model)
    {
    	Comment c = commentService.findById(commentid, commentServiceCallbcak);
    	commentService.update(c, commentServiceCallbcak, text, text);

    	return "redirect:/posts/{postid}";
    }
    
    @PostMapping("/posts/{postid}/comments/{commentid}/delete")
    public String deleteComment(@PathVariable("postid") Long postid,@PathVariable("commentid")Long commentid)
    {
    	Comment c = commentService.findById(commentid, commentServiceCallbcak);
    	commentService.delete(c, commentServiceCallbcak);

    	return "redirect:/posts/{postid}";
    }
    
}

```
## PostController  
```java
package com.test1017.controller.post;

import java.util.ArrayList;
import java.util.List;import java.util.stream.Collectors;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

import com.test1017.converter.CommentDTOconverter;
import com.test1017.converter.PostDTOConverter;
import com.test1017.dao.impl.UserDao;
import com.test1017.dto.CommentDTO;
import com.test1017.dto.PostDTO;
import com.test1017.entity.Comment;
import com.test1017.entity.Post;
import com.test1017.entity.User;
import com.test1017.service.CommentService;
import com.test1017.service.EntityCallback;
import com.test1017.service.PostService;

import jakarta.servlet.http.HttpServletRequest;
import jakarta.validation.Valid;

@Controller
public class PostController 
{
	private static final int PAGE_SIZE = 5; 
	@Autowired
	PostService postService;
	
	@Autowired
	@Qualifier("userDao")
	UserDao userDao;
	
    @Autowired
    @Qualifier("postCallbackImpl")
    private EntityCallback<Post> postCallbackImpl;
    
	@Autowired
	@Qualifier("commentService")
	CommentService commentService;
	
	@Autowired
	@Qualifier("commentServiceCallbcak")
	private EntityCallback<Comment> commentServiceCallbcak;

	
    @GetMapping("/posts")
    public String search(@RequestParam(value = "page", defaultValue = "1") int page,
    		 @RequestParam(value = "search", required = false) String search,
    		 Model model) {

    	
    	 if (search != null && !search.isEmpty()) {
    		 if(postService.searchPostsByName(search, page, PAGE_SIZE) != null)
    		 {
    	    		List <PostDTO> postdto = PostDTOConverter.toPostDTOList(postService.searchPostsByName(search, page, PAGE_SIZE));
    	    		long totalPosts = postService.countPostsByName(search);
    	    		int totalPages = (int) Math.ceil((double) totalPosts / PAGE_SIZE);
    	            model.addAttribute("posts", postdto);
    	            model.addAttribute("currentPage", page);
    	            model.addAttribute("totalPages", totalPages);
    	            model.addAttribute("search", search); // 검색어 전달
    		 }

    	 }
 		else {
            // 기존 게시글 목록 조회
            long totalPosts = postService.countPosts();
            int totalPages = (int) Math.ceil((double) totalPosts / PAGE_SIZE);
            System.out.println("토탈포스트"+totalPosts + "토탈페이지" + totalPages);
            if (postService.findPostsByPage(page, PAGE_SIZE) != null)
            {
            	
            	List<Post> posts = postService.findPostsByPage(page, PAGE_SIZE);
                System.out.println("Test posts Size: "  + posts.size());
                List<PostDTO> postdto = PostDTOConverter.toPostDTOList(postService.findPostsByPage(page, PAGE_SIZE));
                System.out.println("Test DTO Size: "  + postdto.size());
                model.addAttribute("posts", postdto);
                model.addAttribute("currentPage", page);
                model.addAttribute("totalPages", totalPages);
           
            }
   
        }

        // search.jsp로 반환
        return "mainpageWithPost"; // search.jsp 파일을 가리킴
    }
    
    @GetMapping("/posts/new")
    public String showNewPostForm(Model model) {
        List<User> users = userDao.getAlluser();
        model.addAttribute("post", new PostDTO());
        model.addAttribute("userList",users);
        return "post/new";
    }
    
    @PostMapping("/posts")
    public String createPost(@Valid @ModelAttribute("post") PostDTO postdto,
    		BindingResult result) {
        if (result.hasErrors()) {
            return "post/new";
        }
        
        Post post = PostDTOConverter.toEntity(postdto, postdto.getUser());
        postService.post(post, postCallbackImpl);
        return "redirect:/";	
    }
    
    @PostMapping("/users")
    public String creatUser(@ModelAttribute User user)
    {
    	userDao.saveUser(user);
    	return "redirect:/";
    }
    
    @GetMapping("/users")
    public String getMethodName() {
        return "creatUser";
    }
    
    @GetMapping("/posts/search")
    public String getSearch(Model model, @RequestParam(value = "search", required = false) String search) {
        List<PostDTO> postdto = PostDTOConverter.toPostDTOList(postService.searchPostsByName(search, 1, PAGE_SIZE));
        System.out.println("검색갯수 :" + postdto.size());
        model.addAttribute("posts", postdto);
        return "post/searchPost";
    }
    
//    @GetMapping("/searchPost")
//    public String getSearchpost(Model model) {
//    	
//        return "redirect:/posts/search";
//    }
//    
    @GetMapping("/searchPost")
    public String getSearchpost(Model model, @RequestParam(value = "search", required = false) String search) {
        List<PostDTO> postdto = PostDTOConverter.toPostDTOList(postService.searchPostsByName(search, 1, PAGE_SIZE));
        System.out.println("검색갯수 :" + postdto.size());
        model.addAttribute("posts", postdto);
        return "post/searchPost";
    }
    
    
    @GetMapping("/posts/{id}")
    public String getMethodName(@PathVariable("id") Long id,Model model) {
    	Post post = postService.findById(id, postCallbackImpl);
    	if(commentService.findByPostid(post.getPostid()) != null)
    	{
    		List<Comment> coms = commentService.findByPostid(post.getPostid());
    		List<CommentDTO> comments = CommentDTOconverter.toDtoList(coms);
        	model.addAttribute("comments",comments);
    	}
     
        List<User> users = userDao.getAlluser();
        
        
        model.addAttribute("userList",users);
     	model.addAttribute("comment", new CommentDTO());
    	model.addAttribute("post",post);

        return "post/detail";
    }
    
    @GetMapping("/posts/{id}/edit")
    public String getEdit(@PathVariable("id") Long id, Model model)
    {
    	Post post = postService.findById(id, postCallbackImpl);
    	model.addAttribute("post",post);
    	return "post/edit";
    }
    
    
    
    @PostMapping("/posts/{id}/edit")
    public String getEditpst(@PathVariable("id") Long id, Model model,@RequestParam("title")String title, @RequestParam("text")String text)
    {
    	Post post = postService.findById(id, postCallbackImpl);
    	postService.update(post, postCallbackImpl,title,text);
    	model.addAttribute("post",post);
    	return "redirect:/";
    }
    
   
    @PostMapping("/posts/{id}/delete")
    public String getdeletepst(@PathVariable("id") Long id, Model model)
    {
    	Post post = postService.findById(id, postCallbackImpl);
    	postService.delete(post, postCallbackImpl);
    	model.addAttribute("post",post);
    	return "redirect:/";
    }   
    @PostMapping("/posts/{id}/comments")
    public String addComment(@Valid @ModelAttribute("comment") CommentDTO comment,
    		BindingResult result, @PathVariable("id") Long id, @RequestParam("user.userid")Long userid)
    {
        if (result.hasErrors()) {
            return "post/new";
        }
        PostDTO podto = PostDTOConverter.toDto(postService.findById(id, postCallbackImpl));
        		
        User user = userDao.findUserbyid(userid);
        Comment comment1 = CommentDTOconverter.toEntity(comment, podto,user);
        comment1.setPost(postService.findById(id, postCallbackImpl));
        comment1.setUser(user);
        commentService.post(comment1, commentServiceCallbcak);

        return "redirect: /posts/{id}";
    }   
}

```
## WebController
```java  
package com.test1017.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class WebController {

	@GetMapping("/")
	public String getMethodName() {
		return "redirect:/posts";
	}
	
}

```

# init
```java 
package com.test1017.init;

import org.springframework.web.WebApplicationInitializer;
import org.springframework.web.context.ContextLoaderListener;
import org.springframework.web.context.support.AnnotationConfigWebApplicationContext;
import org.springframework.web.servlet.DispatcherServlet;

import com.test1017.config.Appconfig;
import com.test1017.config.Webconfig;

import jakarta.servlet.ServletContext;
import jakarta.servlet.ServletException;
import jakarta.servlet.ServletRegistration;

public class MyWebApplicationInitializer implements WebApplicationInitializer{

	@Override
	public void onStartup(ServletContext servletContext) throws ServletException {
		// TODO Auto-generated method stub
		AnnotationConfigWebApplicationContext rootContext= new AnnotationConfigWebApplicationContext();
		rootContext.register(Appconfig.class);
		rootContext.refresh();
		servletContext.addListener(new ContextLoaderListener(rootContext));
		
		AnnotationConfigWebApplicationContext webContext = new AnnotationConfigWebApplicationContext();
		webContext.register(Webconfig.class);
		
		ServletRegistration.Dynamic dispatcher = servletContext.addServlet("dispatcher", new DispatcherServlet(webContext));

		if (dispatcher != null) 
		{
				dispatcher.setLoadOnStartup(1);
	            dispatcher.addMapping("/");
	    } 
		else 
		{
	            throw new ServletException("Failed to register DispatcherServlet.");
	    }

		
		
	}

}

```

# Service


## PostService
```java
package com.test1017.service;

import java.util.List;

import com.test1017.entity.Post;


public interface PostService extends EntityService<Post, EntityCallback<Post>> {
	
//	Post findById(Long postId);
	
	List<Post> findPostsByPage(int page, int pageSize); // 페이지별 게시글 조회
    long countPosts(); // 전체 게시글 개수 조회
    
    // 검색 기능 추가
    List<Post> searchPostsByName(String name, int page, int pageSize);

    long countPostsByName(String name);
}
```  
## EntityService
```java 
package com.test1017.service;

import java.util.List;

public interface EntityService<T, C> {

    /**
     * Generic method for posting an entity. Prepares the entity for storage before invoking the callback to do
     * the actual work of saving the entity.
     * 
     * @param entity the entity to save
     * @param callback the callback that handles the persistence logic
     */
    void post(T entity, C callback);
    
    T findById(Long id, C callback);
    
    List<T> findAll(C callback);
    
    void update(T entity, C callback, String title, String text);
    
    void delete(T entity, C callback);
}
```

## EntityCallback  
```java
package com.test1017.service;

import java.util.List;

public interface EntityCallback<T> {
    
    void post(T entity);
    
    T findById(Long id);
    
    List<T> findAll();
    
    void update(T entity,String title, String text);
    
    void delete(T entity);
}
```
## DefaultTextFilter

```java
package com.test1017.service;

import org.apache.commons.lang3.StringEscapeUtils;
import org.springframework.stereotype.Component;

import com.opensymphony.module.sitemesh.html.TextFilter;

/*
 텍스트 필터링 로직은 사용자의 입력을 정리하거나 보안적으로 취약한 입력(예: XSS 공격, SQL 인젝션)을 방지하기 위해 사용하는 것입니다. 
 여기서는 HTML 태그 제거, 스크립트 방지와 같은 보안과 데이터 정리 목적의 필터링 로직을 구현할 수 있습니다.
 */
@Component
public class DefaultTextFilter implements TextFilter {
    @Override
    public String filter(String input) {
        if (input == null) {
            return null;
        }
        
        return input;

        /*
        // 1. Trim whitespace (앞뒤 공백 제거)
        String filtered = input.trim();

        // 2. Escape HTML characters (HTML 인젝션 방지)
        filtered = StringEscapeUtils.escapeHtml4(filtered);

        // 3. Remove script tags (XSS 방지)
        filtered = filtered.replaceAll("(?i)<script.*?>.*?</script>", "");  // 대소문자 무시하고 script 태그 제거

        // 4. Remove other potentially dangerous tags (iframe, object 등)
        filtered = filtered.replaceAll("(?i)<iframe.*?>.*?</iframe>", "");
        filtered = filtered.replaceAll("(?i)<object.*?>.*?</object>", "");
        filtered = filtered.replaceAll("(?i)<embed.*?>.*?</embed>", "");
        filtered = filtered.replaceAll("(?i)<applet.*?>.*?</applet>", "");
        
        // 5. Normalize extra spaces to a single space
        filtered = filtered.replaceAll("\\s+", " ");

        return filtered;
        */
    }
}
```

## CommentService
```java
package com.test1017.service;

import java.util.List;

import com.test1017.entity.Comment;

public interface CommentService extends EntityService<Comment,EntityCallback<Comment>>{
	List<Comment> findByPostid(Long postid);


}
```

## implements   

## PostServiceImpl
```java
package com.test1017.service.impl;

import java.util.List;

import javax.inject.Inject;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.util.UriComponentsBuilder;

import com.test1017.dao.Postdao;
import com.test1017.entity.Post;
import com.test1017.service.DefaultTextFilter;
import com.test1017.service.EntityCallback;
import com.test1017.service.PostService;



@Service
@Transactional //boolean readOnly() default false;
@Qualifier("postService")
public class PostServiceImpl implements PostService {
    @Inject 
    private DefaultTextFilter textFilter;
    
    @Autowired
    private Postdao postDao;


    public DefaultTextFilter getTextFilter() { return textFilter; }


	@Override
	public void post(Post post, EntityCallback<Post> callback) {
		callback.post(post);
		
	}


	@Override
	public Post findById(Long id, EntityCallback<Post> callback) {
		return callback.findById(id);
	}


	@Override
	public List<Post> findAll(EntityCallback<Post> callback) {
		// TODO Auto-generated method stub
		return null;
	}


	@Override
	public void update(Post entity, EntityCallback<Post> callback,String title, String text) {
		// TODO Auto-generated method stub
		callback.update(entity,title,text);
	}


	@Override
	public void delete(Post entity, EntityCallback<Post> callback) {
		// TODO Auto-generated method stub
		callback.delete(entity);
	}


	@Override
	public List<Post> findPostsByPage(int page, int pageSize) {
		return postDao.findPostsByPage(page, pageSize);
	}


	@Override
	public long countPosts() {
		// TODO Auto-generated method stub
		if(postDao.findAll() != null)
		{
			return postDao.findAll().size();
		}
		
		return 0;
	}


	@Override
	public List<Post> searchPostsByName(String name, int page, int pageSize) {
		List<Post> posts = postDao.searchPostsByName(name, page, pageSize);
		return posts;
	}


	@Override
	public long countPostsByName(String name) {
		// TODO Auto-generated method stub
		return 0;
	}

    
    
}
```

## PostCallbackImpl
```java
package com.test1017.service.impl;

import java.util.List;

import javax.inject.Inject;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Isolation;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.util.Assert;

import com.test1017.dao.Postdao;
import com.test1017.entity.Post;
import com.test1017.service.EntityCallback;




@Service
@Qualifier("postCallbackImpl")
public class PostCallbackImpl implements EntityCallback<Post>{

	@Autowired
	@Qualifier("postDao")
	private Postdao postDao;
	
	public void post(Post post) {
		Assert.notNull(post, "post can't be null");
		postDao.save(post);			
	}

	@Override
	public Post findById(Long id) {
		return postDao.findById(id);
	}

	@Override
	public List<Post> findAll() {
		return postDao.findAll();
	}	

	@Override
	public void delete(Post post) {
		postDao.delete(post);
	}

	@Override
	public void update(Post entity,String title, String text) {
		postDao.update(entity,title,text);
		
	}

}

```

## CommentServiceImpl

```java
package com.test1017.service.impl;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Service;

import com.test1017.dao.CommentDao;
import com.test1017.entity.Comment;
import com.test1017.service.CommentService;
import com.test1017.service.EntityCallback;


@Service
@Qualifier("commentService")
public class CommentServiceImpl implements CommentService{

	@Autowired
	@Qualifier("commentDao")
	CommentDao commentDao;
	
	@Override
	public void post(Comment entity, EntityCallback<Comment> callback) {
		callback.post(entity);
		
	}

	@Override
	public Comment findById(Long id, EntityCallback<Comment> callback) {
		// TODO Auto-generated method stub
		return callback.findById(id);
	}

	@Override
	public List<Comment> findAll(EntityCallback<Comment> callback) {
		// TODO Auto-generated method stub
		return callback.findAll();
	}

	@Override
	public void update(Comment entity, EntityCallback<Comment> callback, String title, String text) {
		// TODO Auto-generated method stub
		callback.update(entity, title, text);
		
	}

	@Override
	public void delete(Comment entity, EntityCallback<Comment> callback) {
		// TODO Auto-generated method stub
		callback.delete(entity);
	}

	@Override
	public List<Comment> findByPostid(Long postid) {
		// TODO Auto-generated method stub
		return commentDao.findByPostid(postid);
	}

}

```
## CommentCallbackimpl

```java
package com.test1017.service.impl;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Service;

import com.test1017.dao.CommentDao;
import com.test1017.entity.Comment;
import com.test1017.service.CommentService;
import com.test1017.service.EntityCallback;

@Service
@Qualifier("commentServiceCallbcak")
public class CommentCallbackimpl implements EntityCallback<Comment>{

	@Autowired
	@Qualifier("commentDao")
	CommentDao commentDao;



	@Override
	public void post(Comment entity) {
		// TODO Auto-generated method stub
		commentDao.save(entity);
	}

	@Override
	public Comment findById(Long id) {
		// TODO Auto-generated method stub
		return commentDao.findById(id);
	}

	@Override
	public List<Comment> findAll() {
		// TODO Auto-generated method stub
		return commentDao.findAll();
	}

	@Override
	public void update(Comment entity, String title, String text) {
		// TODO Auto-generated method stub
		commentDao.update(entity, text);
	}

	@Override
	public void delete(Comment entity) {
		// TODO Auto-generated method stub
		commentDao.delete(entity);
	}
	
}

```

# Dao

## Postdao
```java
package com.test1017.dao;

import java.util.List;

import com.test1017.entity.Post;

public interface Postdao {
	void save(Post post);
	Post findById(Long id);
	List<Post> findAll();
	void delete(Post post);
	void update(Post entity,String title, String text);
	List<Post> searchPostsByName(String name, int page, int pageSize);
	long countPostsByName(String name);
	public List<Post> findPostsByPage(int page, int pageSize);
}

```

## CommentDao
```java
package com.test1017.dao;

import java.util.List;

import com.test1017.entity.Comment;
import com.test1017.entity.Post;

public interface CommentDao {
	void save(Comment post);
	Comment findById(Long id);
	List<Comment> findAll();
	void delete(Comment post);
	void update(Comment entity, String text);
	List<Comment> findByPostid(Long postid);
}

```

## UserDao
```java
package com.test1017.dao.impl;

import java.util.List;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.querydsl.jpa.impl.JPAQueryFactory;
import com.test1017.dto.PostDTO;
import com.test1017.entity.Post;
import com.test1017.entity.QUser;
import com.test1017.entity.User;

import jakarta.annotation.PostConstruct;
import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;

@Repository
@Qualifier("userDao")
public class UserDao {
	@PersistenceContext
	EntityManager em;
	
	private JPAQueryFactory queryFactory;
	
    @PostConstruct
    public void init() {
        this.queryFactory = new JPAQueryFactory(em);
    }
    @Transactional
    public void saveUser(User user)
    {
    	em.persist(user);
    }
    
    @Transactional
    public List<User> getAlluser()
    {
    	QUser qUser = QUser.user; 
    	return queryFactory.selectFrom(qUser).fetch();
    
    }
    
    public List<Post> getAllpost(User user)
    {
    	return null;
    }
    
    
    public User findUserbyid(Long id)
    {
    	return em.find(User.class, id);
    }
}

```

## PostDaoimpl
```java
package com.test1017.dao.impl;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.querydsl.jpa.impl.JPAQueryFactory;
import com.test1017.Main;
import com.test1017.dao.Postdao;
import com.test1017.entity.Post;
import com.test1017.entity.QPost;
import com.test1017.entity.QUser;
import com.test1017.entity.User;

import jakarta.annotation.PostConstruct;
import jakarta.persistence.EntityManager;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.EntityTransaction;
import jakarta.persistence.PersistenceContext;

@Repository
@Qualifier("postDao")
public class PostDaoimpl implements Postdao{

	@PersistenceContext
	EntityManager em;
	
	private JPAQueryFactory queryFactory;
	
    @PostConstruct
    public void init() {
        this.queryFactory = new JPAQueryFactory(em);
    }
	
	@Override
	public void save(Post post) {
		em.persist(post);

		
	}

	@Override
	public Post findById(Long id) {
		QPost post = QPost.post;
		
		return queryFactory.selectFrom(post).where(post.postid.eq(id)).fetchOne();
	}

	@Override
	public List<Post> findAll() {
		// TODO Auto-generated method stub
		QPost post = QPost.post;
		
		return queryFactory.selectFrom(post).fetch();
	}

	@Transactional
	@Override
	public void delete(Post entity) {
	       Post existingPost = em.find(Post.class, entity.getPostid());
	       
	       
	       em.createNativeQuery("DELETE FROM post WHERE post_id = :id")
	       .setParameter("id", existingPost.getPostid())
	       .executeUpdate();
	}

	@Override
	public void update(Post entity,String title, String text) {
       Post existingPost = em.find(Post.class, entity.getPostid());

        if (existingPost != null) {
            existingPost.setTitle(title); 
            existingPost.setText(text);   
            em.merge(existingPost);  
        }
		
	}
	
    @SuppressWarnings("deprecation")
	public long countPostsByName(String search) {

    	QUser quser = QUser.user;

        return queryFactory
                .selectFrom(quser)
                .where(quser.userName.containsIgnoreCase(search)) // 검색어가 포함된 name
                .fetchCount(); // 개수 반환
    }
    
    @Override
    public List<Post> searchPostsByName(String search, int page, int pageSize) {
    	QUser user = QUser.user;
    	QPost post = QPost.post;


    	return queryFactory
    	         .selectFrom(post)
    	         .leftJoin(post.user, user) // Post와 User의 관계에 맞는 조인 설정
    	         .where(user.userName.containsIgnoreCase(search)) // 검색 조건
    	         .fetch();

    }

	@Override
	public List<Post> findPostsByPage(int page, int pageSize) {
		
		// TODO Auto-generated method stub
	   	if (page < 1) {
    		page = 1;
    	}
    	
        QPost post = QPost.post;
        return queryFactory
                .selectFrom(post)
                .orderBy(post.creationDate.desc()) // 원하는 정렬 방식 적용
                .offset((page - 1) * pageSize) // 페이지 오프셋 계산
                .limit(pageSize) // 한 페이지당 몇 개의 포스트를 가져올지 제한
                .fetch();

	}
	


}

```
## CommentDaoimp
```java
package com.test1017.dao.impl;

import java.util.List;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.querydsl.jpa.impl.JPAQueryFactory;
import com.test1017.dao.CommentDao;
import com.test1017.entity.Comment;
import com.test1017.entity.Post;
import com.test1017.entity.QComment;

import jakarta.annotation.PostConstruct;
import jakarta.persistence.EntityManager;
import jakarta.persistence.PersistenceContext;

@Repository
@Qualifier("commentDao")
public class CommentDaoimp implements CommentDao{
	@PersistenceContext
	EntityManager em;
	
	private JPAQueryFactory queryFactory;
	
    @PostConstruct
    public void init() {
        this.queryFactory = new JPAQueryFactory(em);
    }
    @Transactional
	@Override
	public void save(Comment comment) {
		// TODO Auto-generated method stub
		em.persist(comment);
		
	}

	@Override
	public Comment findById(Long id) {
		QComment qcomment = QComment.comment;
		return queryFactory.selectFrom(qcomment).where(qcomment.commentid.eq(id)).fetchOne();
	}

	@Override
	public List<Comment> findAll() {
		// TODO Auto-generated method stub
		QComment qcomment = QComment.comment;
		return queryFactory.selectFrom(qcomment).fetch();
	}

	@Transactional
	@Override
	public void delete(Comment comment) {
		// TODO Auto-generated method stub
		Comment exitingcomment = em.find(Comment.class, comment.getCommentid());
	       
	       
	       em.createNativeQuery("DELETE FROM comment WHERE comment_id = :id")
	       .setParameter("id", exitingcomment.getCommentid())
	       .executeUpdate();
		
	}

	@Transactional
	@Override
	public void update(Comment comment, String text) {
		Comment exitingcomment = em.find(Comment.class, comment.getCommentid());
		
		if(exitingcomment != null)
		{
			exitingcomment.setText(text);
			em.merge(exitingcomment);
		}

	}
	@Override
	public List<Comment> findByPostid(Long postid) {
		QComment qcomment = QComment.comment;
		
		return queryFactory.selectFrom(qcomment).where(qcomment.post.postid.eq(postid)).fetch();
	}

}

```

---

# 뷰파일

## Edit Comment
```jsp
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form" %>
<!DOCTYPE html>
<html>
<head>
    <title>Edit Comment</title>
</head>
<body>
    <h1>Edit Comment</h1>
    <form:form method="post" modelAttribute="comment" action="${pageContext.request.contextPath}/posts/${post.postid}/comments/${commentid}/edit">
        
        <label for="text">Comment:</label>
        <form:textarea path="text" />
        <br/>
        
        <button type="submit">Update Comment</button>
    </form:form>
    
    <a href="${pageContext.request.contextPath}/posts/${post.postid}">Cancel</a>
</body>
</html>
```
## Post Detail
```jsp
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form" %>
<!DOCTYPE html>
<html>
<head>
    <title>Post Detail</title>
</head>
<body>
    <h1>${post.title}</h1>
    <p><strong>title:</strong> ${post.title}</p>
    <p><strong>user:</strong> ${post.user.userName}</p>
    <p><strong>Text:</strong> ${post.text}</p>

    <!-- 게시글 수정 -->
	<a href="${pageContext.request.contextPath}/posts/${post.postid}/edit" class="btn">Edit Post</a>

 

    <!-- 게시글 삭제 버튼 -->
    <form action="${pageContext.request.contextPath}/posts/${post.postid}/delete" method="post">
        <button type="submit" class="btn btn-cancel" onclick="return confirm('Are you sure you want to delete this post?');">Delete Post</button>
    </form>

    <a href="${pageContext.request.contextPath}/posts">Back to Posts</a>
	
	
	<!-- 댓글 목록 -->
	<h2>Comments</h2>
	<c:if test="${!empty comments}">
	    <ul>
	        <c:forEach var="comment" items="${comments}">
	            <li>
	                <strong>comment | ${comment.user.userName} (UserName)</strong>: ${comment.text}
	                <form method="get" action="${pageContext.request.contextPath}/posts/${post.postid}/comments/${comment.commentid}/edit" style="display:inline;">
	                    <button type="submit">Edit</button>
	                </form>
	                <form method="post" action="${pageContext.request.contextPath}/posts/${post.postid}/comments/${comment.commentid}/delete" style="display:inline;">
	                    <button type="submit" onclick="return confirm('Are you sure you want to delete this comment?');">Delete</button>
	                </form>
	            </li>
	        </c:forEach>
	    </ul>
	</c:if>
	<c:if test="${empty comments}">
	    <p>No comments yet.</p>
	</c:if>


	 <!-- 댓글 추가 폼 -->
	<h2>Add a Comment</h2>
	<form:form method="post" modelAttribute="comment" action="${pageContext.request.contextPath}/posts/${post.postid}/comments">
		<label for="comment.user">User:</label>
		<select id="USER" name="user.userid" required>
		    <c:forEach var="user" items="${userList}">
		        <option value="${user.userid}">user Name : ${user.userName}</option>
		    </c:forEach>
		</select>
	    <br/>
		
	    <label for="text">Comment:</label>
	    <form:textarea path="text"></form:textarea>
	    <br/>
	    <button type="submit">Submit Comment</button>
	</form:form>
</body>
</html>
```
## Edit Post
```jsp
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form" %>
<!DOCTYPE html>
<html>
<head>
    <title>Edit Post</title>
</head>
<body>
    <h1>Edit Post</h1>

    <form:form method="post" modelAttribute="post" action="${pageContext.request.contextPath}/posts/${post.postid}/edit">
        <label for="title">Title:</label>
        <form:input path="title" />
        <br/>
        <label for="text">Content:</label>
        <form:textarea path="text"></form:textarea>
        <br/>
        <button type="submit">Save</button>
    </form:form>

    <a href="${pageContext.request.contextPath}/posts">Back to Posts</a>
</body>
</html>
```  

##  Create New Post
```jsp
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form" %>
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <title>Create New Post</title>
</head>
<body>
    <h1>Create New Post</h1>

    <form:form method="post" action="${pageContext.request.contextPath}/posts" modelAttribute="post">
        <label for="name">Name:</label>
        <form:input path="title" />
        <br />

        <label for="post.user">User:</label>
		<select id="USER" name="user.userid" required>
		    <c:forEach var="user" items="${userList}">
		        <option value="${user.userid}">user Name : ${user.userName}</option>
		    </c:forEach>
		</select>
        <br />


        <label for="text">Text:</label>
        <form:textarea path="text" />
        <br />

        <button type="submit" class="btn">Submit</button>
        <a href="${pageContext.request.contextPath}/posts">Cancel</a>
    </form:form>
</body>
</html>
```

## Search Posts by Name
```jsp
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Post Search</title>
</head>
<body>
    <h1>Search Posts by Name</h1>
    
	
	<!-- 검색 폼 -->
	 <form action="${pageContext.request.contextPath}/posts/search" method="get">
	     <input type="text" name="search" value="${param.search}" placeholder="Search by name">
	     <button type="submit">Search</button>
	 </form>
    
    <hr/>

    <!-- 검색 결과 출력 -->
    <c:if test="${not empty posts}">
        <h2>Search Results:</h2>
        <ul>
            <c:forEach var="post" items="${posts}">
                <li>Post tile : ${post.title}: || User Name ${post.user.userName}</li>
            </c:forEach>
        </ul>
    </c:if>
    
    <c:if test="${empty posts}">
        <p>No posts found.</p>
    </c:if>

</body>
</html>
```

## Register Page (유저등록)
```jsp
<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Register Page</title>
</head>
<body>
    <h2>회원가입</h2>
    <form action="${pageContext.request.contextPath}/users" method="post">
        
        <label for="passwd">UserName:</label>
        <input type="Text" id="UserName" name="UserName"><br> 
 
        
        
        <button type="submit">Register</button>
    </form>
</body>
</html>

```

## mainpageWithPost
```jsp
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form" %>
<!DOCTYPE html>
<html>
<head>
    <title>Post Detail</title>
</head>
<body>
    <h1>${post.title}</h1>
    <p><strong>title:</strong> ${post.title}</p>
    <p><strong>user:</strong> ${post.user.userName}</p>
    <p><strong>Text:</strong> ${post.text}</p>

    <!-- 게시글 수정 -->
	<a href="${pageContext.request.contextPath}/posts/${post.postid}/edit" class="btn">Edit Post</a>

 

    <!-- 게시글 삭제 버튼 -->
    <form action="${pageContext.request.contextPath}/posts/${post.postid}/delete" method="post">
        <button type="submit" class="btn btn-cancel" onclick="return confirm('Are you sure you want to delete this post?');">Delete Post</button>
    </form>

    <a href="${pageContext.request.contextPath}/posts">Back to Posts</a>
	
	
	<!-- 댓글 목록 -->
	<h2>Comments</h2>
	<c:if test="${!empty comments}">
	    <ul>
	        <c:forEach var="comment" items="${comments}">
	            <li>
	                <strong>comment | ${comment.user.userName} (UserName)</strong>: ${comment.text}
	                <form method="get" action="${pageContext.request.contextPath}/posts/${post.postid}/comments/${comment.commentid}/edit" style="display:inline;">
	                    <button type="submit">Edit</button>
	                </form>
	                <form method="post" action="${pageContext.request.contextPath}/posts/${post.postid}/comments/${comment.commentid}/delete" style="display:inline;">
	                    <button type="submit" onclick="return confirm('Are you sure you want to delete this comment?');">Delete</button>
	                </form>
	            </li>
	        </c:forEach>
	    </ul>
	</c:if>
	<c:if test="${empty comments}">
	    <p>No comments yet.</p>
	</c:if>


	 <!-- 댓글 추가 폼 -->
	<h2>Add a Comment</h2>
	<form:form method="post" modelAttribute="comment" action="${pageContext.request.contextPath}/posts/${post.postid}/comments">
		<label for="comment.user">User:</label>
		<select id="USER" name="user.userid" required>
		    <c:forEach var="user" items="${userList}">
		        <option value="${user.userid}">user Name : ${user.userName}</option>
		    </c:forEach>
		</select>
	    <br/>
		
	    <label for="text">Comment:</label>
	    <form:textarea path="text"></form:textarea>
	    <br/>
	    <button type="submit">Submit Comment</button>
	</form:form>
</body>
</html>
```
---
# persistence
```xml
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://xmlns.jcp.org/xml/ns/persistence" version="2.2">
	
    <persistence-unit name="jpabook">
        <properties>
            <property name="javax.persistence.jdbc.driver" value="org.h2.Driver"/>
            <property name="javax.persistence.jdbc.user" value="root"/>
            <property name="javax.persistence.jdbc.password" value="1234"/>
            <property name="javax.persistence.jdbc.url" value="jdbc:h2:tcp://localhost/~/test"/>
            

            <property name="javax.persistence.schema-generation.database.action" value="create-drop"/>
        </properties>
    </persistence-unit>

</persistence>



```

# pom

```xml
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.test1017</groupId>
  <artifactId>com.test1017</artifactId>
  <version>0.0.1-SNAPSHOT</version>
   <properties>
	  <maven.compiler.source>17</maven.compiler.source>
      <maven.compiler.target>17</maven.compiler.target>
      <spring.version>6.1.6</spring.version>
      <aspectj.version>1.9.22.1</aspectj.version>
      <hibernate.version>5.6.15.Final</hibernate.version>
      <mysql.version>8.3.0</mysql.version>
      <h2db.version>2.2.224</h2db.version>
  </properties>
  
  <dependencies>

	<dependency>
	    <groupId>org.springframework</groupId>
	    <artifactId>spring-core</artifactId>
	    <version>${spring.version}</version>
	</dependency>
	  <!-- https://mvnrepository.com/artifact/org.springframework/spring-context -->
	  <dependency>
		  <groupId>org.springframework</groupId>
	      <artifactId>spring-context</artifactId>
	      <version>${spring.version}</version>
	  </dependency>
	  
	  <dependency>
          <groupId>org.springframework</groupId>
          <artifactId>spring-webmvc</artifactId>
          <version>${spring.version}</version>
      </dependency>
	  
	  <!-- For springframe.mail -->
	  <dependency>
	 	  <groupId>org.springframework</groupId>
	 	  <artifactId>spring-context-support</artifactId>
	 	  <version>${spring.version}</version>
	  </dependency>
	  
		<dependency>
		    <groupId>org.springframework</groupId>
		    <artifactId>spring-web</artifactId>
		    <version>${spring.version}</version> <!-- 프로젝트에 맞는 버전으로 수정 가능 -->
		</dependency>
	
	  
	  <!-- https://mvnrepository.com/artifact/org.springframework/spring-jdbc -->
      <dependency>
		  <groupId>org.springframework</groupId>
	      <artifactId>spring-jdbc</artifactId>
	      <version>${spring.version}</version>
	  </dependency>
	  
	  <dependency>
          <groupId>org.springframework</groupId>
          <artifactId>spring-orm</artifactId>
          <version>${spring.version}</version> <!-- Spring 최신 버전 확인 -->
      </dependency>
	  
	  <!-- https://mvnrepository.com/artifact/org.springframework/spring-aop -->
	  <dependency>
	      <groupId>org.springframework</groupId>
	      <artifactId>spring-aop</artifactId>
	      <version>${spring.version}</version>
	  </dependency>

	  
	  <!-- https://mvnrepository.com/artifact/org.springframework/spring-test -->
	  <dependency>
    	  <groupId>org.springframework</groupId>
    	  <artifactId>spring-test</artifactId>
    	  <version>${spring.version}</version>
    	  <scope>test</scope>
	  </dependency>
	  
	  <dependency>
    	  <groupId>jakarta.persistence</groupId>
    	  <artifactId>jakarta.persistence-api</artifactId>
          <version>3.1.0</version> <!-- 최신 버전 확인 -->
	  </dependency>

	  
	  <dependency>
    	  <groupId>org.hibernate</groupId>
    	  <artifactId>hibernate-core</artifactId>
    	  <version>6.5.2.Final</version>
	  </dependency>
	  
	  <dependency>
    	  <groupId>org.aspectj</groupId>
    	  <artifactId>aspectjweaver</artifactId>
    	  <version>${aspectj.version}</version> 
  	  </dependency>	
	  
	  <dependency>
          <groupId>com.querydsl</groupId>
          <artifactId>querydsl-jpa</artifactId>
          <version>5.0.0</version>
          <classifier>jakarta</classifier>
      </dependency>
      
      <!-- QueryDSL APT(Annotation Processing Tool) -->
      <dependency>
          <groupId>com.querydsl</groupId>
          <artifactId>querydsl-apt</artifactId>
          <version>5.0.0</version>
          <scope>provided</scope>
      </dependency>
        
      <dependency>
		  <groupId>org.projectlombok</groupId>
          <artifactId>lombok</artifactId>
          <version>1.18.30</version>
          <scope>provided</scope>
      </dependency>

      <dependency>
          <groupId>com.fasterxml.jackson.core</groupId>
          <artifactId>jackson-databind</artifactId>
          <version>2.17.1</version>
      </dependency>        
        
	  <dependency>
 		  <groupId>com.sun.mail</groupId>
 		  <artifactId>jakarta.mail</artifactId>
 		  <version>2.0.1</version>
	  </dependency>
	  
	  <dependency>
	      <groupId>org.mockito</groupId>
	      <artifactId>mockito-core</artifactId>
	      <version>5.2.0</version>
	      <!-- <scope>test</scope> -->
	  </dependency>
	
	  <!-- https://mvnrepository.com/artifact/jakarta.servlet/jakarta.servlet-api -->
	  <dependency>
	      <groupId>jakarta.servlet</groupId>
	      <artifactId>jakarta.servlet-api</artifactId>
	      <version>6.0.0</version>
	      <scope>provided</scope>
	  </dependency>

	  <!-- https://mvnrepository.com/artifact/org.apache.tomcat.embed/tomcat-embed-core -->
	  <dependency>
	      <groupId>org.apache.tomcat.embed</groupId>
	      <artifactId>tomcat-embed-core</artifactId>
	      <version>10.1.25</version>
	  </dependency>

	  <!-- https://mvnrepository.com/artifact/org.apache.tomcat.embed/tomcat-embed-jasper -->
	  <dependency>
	      <groupId>org.apache.tomcat.embed</groupId>
	      <artifactId>tomcat-embed-jasper</artifactId>
	      <version>10.1.25</version>
	  </dependency>
	
	  <!-- https://mvnrepository.com/artifact/org.apache.tomcat.embed/tomcat-embed-logging-juli -->
	  <dependency>
	      <groupId>org.apache.tomcat.embed</groupId>
	      <artifactId>tomcat-embed-logging-juli</artifactId>
	      <version>8.5.2</version>
	  </dependency>

	  <!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api -->
	  <dependency>
    	  <groupId>org.junit.jupiter</groupId>
    	  <artifactId>junit-jupiter-api</artifactId>
    	  <version>5.10.1</version>
    	  <scope>test</scope>
	  </dependency>


	  <!-- https://mvnrepository.com/artifact/com.mysql/mysql-connector-j -->
	  <dependency>
          <groupId>com.mysql</groupId>
          <artifactId>mysql-connector-j</artifactId>
          <version>${mysql.version}</version>
      </dependency>
      
      <dependency>
	      <groupId>com.h2database</groupId>
	      <artifactId>h2</artifactId>
	      <version>${h2db.version}</version>
	      <!--<scope>test</scope>-->
	  </dependency>	 
	  
	  <!-- For @PostConstruct annotation!!!-->
	  <dependency>
	      <groupId>jakarta.annotation</groupId>
	      <artifactId>jakarta.annotation-api</artifactId>
	      <version>3.0.0</version>
	  </dependency>
	
	  <!-- https://mvnrepository.com/artifact/jakarta.validation/jakarta.validation-api -->
	  <dependency>
	      <groupId>jakarta.validation</groupId>
	      <artifactId>jakarta.validation-api</artifactId>
	      <version>3.1.0</version>
	  </dependency>
	
	  <!-- https://mvnrepository.com/artifact/org.hibernate.validator/hibernate-validator -->
	  <dependency>
	      <groupId>org.hibernate.validator</groupId>
	      <artifactId>hibernate-validator</artifactId>
	      <version>8.0.1.Final</version>
	  </dependency>
	
	  <!-- https://mvnrepository.com/artifact/opensymphony/sitemesh -->
	  <dependency>
	      <groupId>opensymphony</groupId>
	      <artifactId>sitemesh</artifactId>
	      <version>2.6.0</version>
	  </dependency>
	  
	  <dependency>
    	  <groupId>commons-fileupload</groupId>
          <artifactId>commons-fileupload</artifactId>
          <version>1.4</version> <!-- 최신 버전 확인 가능 -->
      </dependency>

	  <dependency>
    	  <groupId>org.apache.commons</groupId>
    	  <artifactId>commons-lang3</artifactId>
    	  <version>3.13.0</version> <!-- 최신 버전 확인 -->
	  </dependency>

	  <!-- 
	  <dependency>
    	  <groupId>org.slf4j</groupId>
    	  <artifactId>slf4j-api</artifactId>
    	  <version>2.0.9</version> 
	  </dependency>
	  -->
	
	  <!-- Log4j2 (실제 로깅을 처리하는 구현체) -->
      <dependency>
          <groupId>org.apache.logging.log4j</groupId>
          <artifactId>log4j-core</artifactId>
          <version>2.20.0</version> <!-- Log4j 최신 버전 확인 -->
      </dependency>

      <!-- SLF4J를 Log4j2로 연결하는 어댑터 -->
      <dependency>
          <groupId>org.apache.logging.log4j</groupId>
          <artifactId>log4j-slf4j-impl</artifactId>
          <version>2.20.0</version> <!-- Log4j 최신 버전 확인 -->
      </dependency>
	
	  <dependency>
    	  <groupId>ch.qos.logback</groupId>
    	  <artifactId>logback-classic</artifactId>
    	  <version>1.4.8</version> <!-- 최신 버전 확인 -->
	  </dependency>
	  
	
	  <dependency>
    	  <groupId>org.apache.tomcat</groupId>
    	  <artifactId>tomcat-dbcp</artifactId>
    	  <version>9.0.80</version>
	  </dependency>
	
	  <dependency>
    	  <groupId>jakarta.servlet.jsp.jstl</groupId>
    	  <artifactId>jakarta.servlet.jsp.jstl-api</artifactId>
    	  <version>2.0.0</version>
	  </dependency>
	
	  <dependency>
    	  <groupId>org.glassfish.web</groupId>
    	  <artifactId>jakarta.servlet.jsp.jstl</artifactId>
    	  <version>2.0.0</version>
	  </dependency>

	  <dependency>
          <groupId>jakarta.persistence</groupId>
          <artifactId>jakarta.persistence-api</artifactId>
          <version>3.1.0</version> <!-- 버전은 최신으로 -->
      </dependency>

  </dependencies>

  <build>
	  <plugins>
		  <!-- Maven Compiler Plugin 설정 -->
          <plugin>
			  <groupId>org.apache.maven.plugins</groupId>
              <artifactId>maven-compiler-plugin</artifactId>
              <version>3.8.1</version>
              <configuration>
				  <source>17</source>
                  <target>17</target>
                  <annotationProcessorPaths>
					  <!-- Lombok 설정 -->
                  	  <path>													
							<groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                            <version>1.18.30</version>
                      </path>
                    
                      <!-- QueryDSL APT 설정 -->
                      <path>						  
                          <groupId>com.querydsl</groupId>
                          <artifactId>querydsl-apt</artifactId>
                          <version>5.0.0</version>
                          <classifier>jakarta</classifier>
                      </path>

                      <!-- Jakarta Annotation API -->
                      <path>
                          <groupId>jakarta.annotation</groupId>
                          <artifactId>jakarta.annotation-api</artifactId>
                          <version>3.0.0</version>
                      </path>
                    
                      <!-- Jakarta Persistence API -->
                      <path>
						  <groupId>jakarta.persistence</groupId>
                          <artifactId>jakarta.persistence-api</artifactId>
                          <version>3.1.0</version>
                      </path>
                  </annotationProcessorPaths>

                  <!-- QueryDSL 파일이 생성될 디렉토리 -->
                  <generatedSourcesDirectory>${project.build.directory}/generated-sources/java</generatedSourcesDirectory>

              </configuration>
          </plugin>

          <!-- Maven resources plugin for handling generated-sources directory -->
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-resources-plugin</artifactId>
            <version>3.2.0</version>
            <executions>
				<execution>
					<id>copy-resources</id>
                    <phase>generate-sources</phase>
                    <goals>
                        <goal>copy-resources</goal>
                    </goals>
                    <configuration>
                        <outputDirectory>${project.build.directory}/generated-sources/java</outputDirectory>
                        <resources>
                            <resource>
                                <directory>src/main/resources</directory>
                            </resource>
                        </resources>
                    </configuration>
                </execution>
            </executions>
          </plugin>
        
          <plugin>
			  <groupId>org.codehaus.mojo</groupId>
              <artifactId>build-helper-maven-plugin</artifactId>
              <version>3.2.0</version>
              <executions>
				  <execution>
					  <id>add-source</id>
                      <phase>generate-sources</phase>
                      <goals>
						  <goal>add-source</goal>
                      </goals>
                      <configuration>
						  <sources>
							  <source>${project.build.directory}/generated-sources/java</source>
                          </sources>
                      </configuration>
                  </execution>
              </executions>
          </plugin>

      </plugins>
    
      <sourceDirectory>src/main/java</sourceDirectory>
      <testSourceDirectory>src/test/java</testSourceDirectory>
  </build>
</project>
```   